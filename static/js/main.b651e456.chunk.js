(this.webpackJsonpconway=this.webpackJsonpconway||[]).push([[0],{31:function(t,e,i){},32:function(t,e,i){},48:function(t,e,i){"use strict";i.r(e);var s=i(10),r=i(8),n=i.n(r),a=i(17),c=i.n(a),o=(i(31),i(0)),d=i(1),l=i(3),u=i(2),h=i(6),p=(i(32),i(9)),j=i(5);function b(t){return Object(s.jsx)("td",{onClick:t.handleClick,className:"cell",children:t.val})}var g=function(t){Object(l.a)(i,t);var e=Object(u.a)(i);function i(t){var s;return Object(o.a)(this,i),(s=e.call(this,t)).grid=Object(p.a)(Array(s.props.len).keys()),s}return Object(d.a)(i,[{key:"render",value:function(){var t=this;return Object(s.jsx)("tr",{children:this.grid.map((function(e){var i=t.props.offset*t.props.len+e;return Object(s.jsx)(b,{handleClick:function(i){return t.props.handleCellClick(i,e,t.props.offset)},val:t.props.vals[e]},i)}))})}}]),i}(n.a.Component);function v(t){return Object(s.jsx)("div",{})}var f=function(t){Object(l.a)(i,t);var e=Object(u.a)(i);function i(){var t;Object(o.a)(this,i);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))).setTimer=function(){t.timerID=setInterval((function(){return t.tick()}),250),t.setState(Object(h.a)(Object(h.a)({},t.state),{},{timerSet:!0}))},t.unsetTimer=function(){clearInterval(t.timerID),t.setState(Object(h.a)(Object(h.a)({},t.state),{},{timerSet:!1}))},t.toggleTimer=function(){t.state.timerSet?t.unsetTimer():t.setTimer()},t}return Object(d.a)(i,[{key:"tick",value:function(){throw new Error("tick not implemented")}},{key:"subrender",value:function(){throw new Error("subrender not implemented")}},{key:"componentWillUnmount",value:function(){this.unsetTimer()}},{key:"render",value:function(){return Object(s.jsxs)("div",{children:[this.subrender(),Object(s.jsx)("button",{onClick:this.toggleTimer,children:this.state.timerSet?"Pause":"Play"})]})}}]),i}(n.a.Component),O=i(25),w=function(t){Object(l.a)(i,t);var e=Object(u.a)(i);function i(t){var s;return Object(o.a)(this,i),(s=e.call(this,t)).handleCellClick=function(t,e,i){var r=Object.values(s.state.widgets).filter((function(t){return t.pos[0]===e&&t.pos[1]===i})).flat();if(0===r.length)s.addWidget(e,i);else if(1===r.length){var n=r[0].idx,a=s.widgets[n].dir;a<3?s.widgets[n].dir=(a+1)%4:delete s.widgets[n],s.setState(Object(h.a)(Object(h.a)({},s.state),{},{widgets:s.widgets})),s.updateVals()}},s.grid=Object(p.a)(Array(s.props.gridsize).keys()),s.widgets={},s.synths=[],s.state={widgets:s.widgets,synths:s.synths,vals:s.initVals()},s.ctr=0,s.addWidget=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;s.widgets[s.ctr]={idx:s.ctr,pos:[t,e],dir:0},s.synths.push((new O.a).toDestination()),s.setState(Object(h.a)(Object(h.a)({},s.state),{},{synths:s.synths,widgets:s.widgets})),s.updateVals(),s.ctr+=1},s.handleCellClick.bind(Object(j.a)(s)),document.addEventListener("keydown",(function(t){"Space"===t.code&&s.toggleTimer()})),s}return Object(d.a)(i,[{key:"initVals",value:function(){var t=this;return new Array(this.props.gridsize).fill("_").map((function(e){return new Array(t.props.gridsize).fill("")}))}},{key:"getArrow",value:function(t){return 0===t?"\ud83e\udc7b":1===t?"\ud83e\udc7a":2===t?"\ud83e\udc79":"\ud83e\udc78"}},{key:"updateVals",value:function(){var t=this,e=this.initVals();Object.values(this.widgets).forEach((function(i){return e[i.pos[1]][i.pos[0]]+=t.getArrow(i.dir)})),this.setState(Object(h.a)(Object(h.a)({},this.state),{},{vals:e}))}},{key:"tick",value:function(){var t=this;this.widgets=this.state.widgets,Object.keys(this.widgets).forEach((function(e){return t.updateWidget(e)})),this.setState(Object(h.a)(Object(h.a)({},this.state),{},{widgets:this.widgets})),this.handleCollisions(),this.updateVals()}},{key:"didHitWall",value:function(t,e){var i=this.props.gridsize-1;return 0===e&&t[1]===i||1===e&&t[0]===i||2===e&&0===t[1]||3===e&&0===t[0]}},{key:"makeSound",value:function(t,e,i){var s=0,r=this.props.gridsize-1;s=e%2!==1||0!==t[0]&&t[0]!==r?t[0]:t[1],i.triggerAttackRelease(this.props.scale[s%this.props.scale.length],"8n")}},{key:"updateWidget",value:function(t){var e=this.widgets[t],i=this.synths[t];if(this.didHitWall(e.pos,e.dir)){var s=(e.dir+2)%4;return this.widgets[t].dir=s,void this.makeSound(e.pos,e.dir,i)}var r=e.pos;if(r=0===e.dir?[e.pos[0],(e.pos[1]+1+this.props.gridsize)%this.props.gridsize]:2===e.dir?[e.pos[0],(e.pos[1]-1+this.props.gridsize)%this.props.gridsize]:1===e.dir?[(e.pos[0]+1+this.props.gridsize)%this.props.gridsize,e.pos[1]]:[(e.pos[0]-1+this.props.gridsize)%this.props.gridsize,e.pos[1]],this.widgets[t].pos=r,this.didHitWall(r,e.dir)){var n=(e.dir+2)%4;this.widgets[t].dir=n,this.makeSound(e.pos,e.dir,i)}}},{key:"handleCollisions",value:function(){var t=this,e={};Object.values(this.widgets).forEach((function(t){var i=t.pos+"|"+t.dir;e[i]=t.idx})),Object.keys(e).forEach((function(i){var s=i.split("|")[0]+"|"+(parseInt(i.split("|")[1],10)+2)%4;if(void 0!==e[s]){var r=(t.widgets[e[s]].dir+1)%4;t.widgets[e[s]].dir=r}})),this.setState(Object(h.a)(Object(h.a)({},this.state),{},{widgets:this.widgets}))}},{key:"groupBy",value:function(t,e,i){return t.reduce((function(t,s){return(t[s[e]]=t[s[e]]||[]).push(s[i]),t}),{})}},{key:"subrender",value:function(){var t=this;return Object(s.jsxs)("div",{children:[Object(s.jsx)("table",{children:Object(s.jsx)("tbody",{children:this.grid.map((function(e){return Object(s.jsx)(g,{handleCellClick:t.handleCellClick,offset:e,vals:t.state.vals[e],len:t.props.gridsize},e)}))})}),Object(s.jsx)("br",{}),Object.values(this.state.widgets).map((function(t){return Object(s.jsx)(v,{idx:t.idx,dir:t.dir,pos:t.pos},t.idx)}))]})}}]),i}(f),y=i(18),k=function(t){Object(l.a)(i,t);var e=Object(u.a)(i);function i(){return Object(o.a)(this,i),e.apply(this,arguments)}return Object(d.a)(i,[{key:"render",value:function(){return Object(s.jsx)("div",{className:"App",children:Object(s.jsx)(w,{gridsize:9,scale:["D2","G2","C3","E3","A3","F4","A4","C5","D5"]})})}}]),i}(r.Component),m=Object(y.b)((function(t){return Object(h.a)({},t)}))(k),x=i(14),C=i(24),S=Object(x.c)({});c.a.render(Object(s.jsx)(n.a.StrictMode,{children:Object(s.jsx)(y.a,{store:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(x.d)(S,t,Object(x.a)(C.a))}(),children:Object(s.jsx)(m,{})})}),document.getElementById("root"))}},[[48,1,2]]]);
//# sourceMappingURL=main.b651e456.chunk.js.map