(this.webpackJsonpconway=this.webpackJsonpconway||[]).push([[0],{31:function(t,e,i){},32:function(t,e,i){},48:function(t,e,i){"use strict";i.r(e);var s=i(10),n=i(8),r=i.n(n),a=i(18),c=i.n(a),o=(i(31),i(0)),l=i(1),d=i(3),u=i(2),h=i(6),p=(i(32),i(9)),j=i(5);function b(t){return Object(s.jsx)("td",{onClick:t.handleClick,className:"cell",children:t.val})}var g=function(t){Object(d.a)(i,t);var e=Object(u.a)(i);function i(t){var s;return Object(o.a)(this,i),(s=e.call(this,t)).grid=Object(p.a)(Array(s.props.len).keys()),s}return Object(l.a)(i,[{key:"render",value:function(){var t=this;return Object(s.jsx)("tr",{children:this.grid.map((function(e){var i=t.props.offset*t.props.len+e;return Object(s.jsx)(b,{handleClick:function(i){return t.props.handleCellClick(i,e,t.props.offset)},val:t.props.vals[e]},i)}))})}}]),i}(r.a.Component);function f(t){return Object(s.jsx)("div",{})}var v=function(t){Object(d.a)(i,t);var e=Object(u.a)(i);function i(){var t;Object(o.a)(this,i);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))).setTimer=function(){t.timerID=setInterval((function(){return t.tick()}),t.state.interval),t.setState(Object(h.a)(Object(h.a)({},t.state),{},{timerSet:!0}))},t.unsetTimer=function(){clearInterval(t.timerID),t.setState(Object(h.a)(Object(h.a)({},t.state),{},{timerSet:!1}))},t.toggleTimer=function(){t.state.timerSet?t.unsetTimer():t.setTimer()},t.changeInterval=function(e){var i=parseInt(e.target.value,10);t.setState(Object(h.a)(Object(h.a)({},t.state),{},{interval:3e4/i}))},t}return Object(l.a)(i,[{key:"tick",value:function(){throw new Error("tick not implemented")}},{key:"clear",value:function(){throw new Error("clear not implemented")}},{key:"subrender",value:function(){throw new Error("subrender not implemented")}},{key:"componentWillUnmount",value:function(){this.unsetTimer()}},{key:"render",value:function(){return Object(s.jsxs)("div",{children:[this.subrender(),Object(s.jsxs)("div",{className:"controls",children:[Object(s.jsx)("button",{onClick:this.toggleTimer,children:this.state.timerSet?"Pause":"Play"}),Object(s.jsx)("span",{className:"spacer"}),Object(s.jsx)("button",{onClick:this.clear,children:"Clear"}),Object(s.jsx)("span",{className:"spacer"}),"Tempo:\xa0",Object(s.jsx)("input",{className:"bpm",onChange:this.changeInterval,disabled:this.state.timerSet,type:"number",min:"50",max:"300",placeholder:parseInt(3e4/this.state.interval)})]})]})}}]),i}(r.a.Component),O=i(17),w=function(t){Object(d.a)(i,t);var e=Object(u.a)(i);function i(t){var s;Object(o.a)(this,i),(s=e.call(this,t)).clear=function(){s.widgets={},s.setState(Object(h.a)(Object(h.a)({},s.state),{},{widgets:s.widgets}))},s.handleCellClick=function(t,e,i){var n=Object.values(s.state.widgets).filter((function(t){return t.pos[0]===e&&t.pos[1]===i})).flat();if(0===n.length)s.addWidget(e,i);else if(1===n.length){var r=n[0].idx,a=s.widgets[r].dir;a<3?s.widgets[r].dir=(a+1)%4:delete s.widgets[r],s.setState(Object(h.a)(Object(h.a)({},s.state),{},{widgets:s.widgets})),s.updateVals()}},s.grid=Object(p.a)(Array(s.props.gridsize).keys()),s.widgets={},s.synths=[],s.state={widgets:s.widgets,synths:s.synths,vals:s.initVals(),interval:200},s.ctr=0;var n=new O.b(.3).toDestination(),r=new O.a(.3,.2).toDestination();return s.addWidget=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;s.widgets[s.ctr]={idx:s.ctr,pos:[t,e],dir:0},s.synths.push((new O.c).connect(n).connect(r).toDestination()),s.setState(Object(h.a)(Object(h.a)({},s.state),{},{synths:s.synths,widgets:s.widgets})),s.updateVals(),s.ctr+=1},s.handleCellClick.bind(Object(j.a)(s)),document.addEventListener("keydown",(function(t){"Space"===t.code&&s.toggleTimer()})),s}return Object(l.a)(i,[{key:"initVals",value:function(){var t=this;return new Array(this.props.gridsize).fill("_").map((function(e){return new Array(t.props.gridsize).fill("")}))}},{key:"getArrow",value:function(t){return 0===t?"\u2191":1===t?"\u2192":2===t?"\u2193":"\u2190"}},{key:"updateVals",value:function(){var t=this,e=this.initVals();Object.values(this.state.widgets).forEach((function(i){return e[i.pos[1]][i.pos[0]]+=t.getArrow(i.dir)})),this.setState(Object(h.a)(Object(h.a)({},this.state),{},{vals:e}))}},{key:"tick",value:function(){var t=this;this.widgets=this.state.widgets,Object.keys(this.widgets).forEach((function(e){return t.updateWidget(e)})),this.setState(Object(h.a)(Object(h.a)({},this.state),{},{widgets:this.widgets})),this.handleCollisions(),this.updateVals()}},{key:"didHitWall",value:function(t,e){var i=this.props.gridsize-1;return 0===e&&0===t[1]||1===e&&t[0]===i||2===e&&t[1]===i||3===e&&0===t[0]}},{key:"makeSound",value:function(t,e,i){var s=0,n=this.props.gridsize-1;s=e%2!==1||0!==t[0]&&t[0]!==n?t[0]:n-t[1],i.triggerAttackRelease(this.props.scale[s%this.props.scale.length],"8n",O.d(),.3)}},{key:"updateWidget",value:function(t){var e=this.widgets[t],i=this.synths[t];if(this.didHitWall(e.pos,e.dir)){var s=(e.dir+2)%4;this.widgets[t].dir=s}var n=e.pos;n=2===e.dir?[e.pos[0],(e.pos[1]+1+this.props.gridsize)%this.props.gridsize]:0===e.dir?[e.pos[0],(e.pos[1]-1+this.props.gridsize)%this.props.gridsize]:1===e.dir?[(e.pos[0]+1+this.props.gridsize)%this.props.gridsize,e.pos[1]]:[(e.pos[0]-1+this.props.gridsize)%this.props.gridsize,e.pos[1]],this.widgets[t].pos=n,this.didHitWall(n,e.dir)&&this.makeSound(e.pos,e.dir,i)}},{key:"handleCollisions",value:function(){var t=this,e=Object.values(this.widgets).map((function(t){return[t.idx,t.pos.join(",")]})),i=Object.values(this.groupBy(e,1,0));i.filter((function(t){return t.length>2})).flat().forEach((function(e){t.widgets[e].dir=(t.widgets[e].dir+2)%4})),i.filter((function(t){return 2===t.length})).flat().forEach((function(e){t.widgets[e].dir=(t.widgets[e].dir+1)%4})),this.setState(Object(h.a)(Object(h.a)({},this.state),{},{widgets:this.widgets}))}},{key:"groupBy",value:function(t,e,i){return t.reduce((function(t,s){return(t[s[e]]=t[s[e]]||[]).push(s[i]),t}),{})}},{key:"subrender",value:function(){var t=this;return Object(s.jsxs)("div",{children:[Object(s.jsx)("table",{children:Object(s.jsx)("tbody",{children:this.grid.map((function(e){return Object(s.jsx)(g,{handleCellClick:t.handleCellClick,offset:e,vals:t.state.vals[e],len:t.props.gridsize},e)}))})}),Object(s.jsx)("br",{}),Object.values(this.state.widgets).map((function(t){return Object(s.jsx)(f,{idx:t.idx,dir:t.dir,pos:t.pos},t.idx)}))]})}}]),i}(v),m=i(19),y=function(t){Object(d.a)(i,t);var e=Object(u.a)(i);function i(){return Object(o.a)(this,i),e.apply(this,arguments)}return Object(l.a)(i,[{key:"render",value:function(){return Object(s.jsx)("div",{className:"App",children:Object(s.jsx)(w,{gridsize:9,scale:["E3","B3","C4","D4","E4","F#4","G4","B4","D5"]})})}}]),i}(n.Component),k=Object(m.b)((function(t){return Object(h.a)({},t)}))(y),x=i(14),C=i(25),S=Object(x.c)({});c.a.render(Object(s.jsx)(r.a.StrictMode,{children:Object(s.jsx)(m.a,{store:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(x.d)(S,t,Object(x.a)(C.a))}(),children:Object(s.jsx)(k,{})})}),document.getElementById("root"))}},[[48,1,2]]]);
//# sourceMappingURL=main.01c8bc10.chunk.js.map